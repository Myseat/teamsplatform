---
description: 让外部系统与Teams无缝地整合
---

# 连接器（Connector）

Microsoft Teams 是设计用来作为现代办公的一个枢纽（Hub），这不仅体现在它把微软现有的各种应用或服务很好地整合起来，也意味着它可以与公司现有的各种业务系统无缝地整合。此前我们已经介绍过利用选项卡可以把企业应用整合到客户端界面中来（可点击下面的链接了解），这一节则要谈一谈另外一种层面的整合：数据和逻辑层面。

{% page-ref page="teams-tab-overview.md" %}

连接器适用的典型场景是：

1. **在客户端中接收来自外部系统的通知消息**。你可以先进行订阅然后定期接收，也可以在具体事件发生时接收推送。
2. **在客户端中发送消息给外部系统**。你可以以一种与机器人交互的类似体验，给外部系统进行整合，但这里不要求你的外部系统实现机器人的框架，也不要求部署到微软的机器人平台。

连接器是专属频道的扩展功能，目前不支持针对个人，或者群聊，会议设置连接器。如果需要配置连接器，需要选择某个频道，然后在快捷菜单中选择 `连接器`。

![](../../.gitbook/assets/tu-pian-%20%2839%29.png)

## 订阅外部系统的通知

其实连接器这个技术，早在2016年就在Office 365中引入了，当时是主要应用于Outlook客户端，如果有兴趣，你可以参考下面这个官方的文档介绍（英文）。

{% embed url="https://www.microsoft.com/en-us/microsoft-365/blog/2016/03/25/introducing-office-365-connectors/" %}

Office 365的连接器，是基于 `订阅/发布` 这种架构来实现的，即外部事件源需要预先定义一个订阅配置页面，Outlook用户主动地发起订阅某些事件，设置希望接收的频率（或条件），然后这些配置保存在外部事件源的系统中，在特定的时间到来时或特定事件发生时，它会通过一个特定的地址给Outlook客户端推送消息。

同样的逻辑，现在也可以用到Microsoft Teams 里面来，目前已经有上百个按照Office 365 连接器规划做好的应用直接可以使用。例如下面这个例子是我们使用RSS 这个标准连接器，为某个频道订阅主题为 `Teams 平台` 的博客推送，并且要求它每6个小时推送一次。

![](../../.gitbook/assets/tu-pian-%20%2832%29.png)

完成配置后，用户可以在频道中看到相关的信息，并立即接收到第一次的推送（通常是10条内容），然后每隔一段时间（这里设置为6小时），用户又会收到最新的10条内容。

![](../../.gitbook/assets/tu-pian-%20%2838%29.png)

类似的场景还有非常多，例如研发团队希望接收Github或者DevOps系统中的事件通知，或者经理希望接收办公自动化（OA）系统的审批通知等。

这种针对某个特定事件源的订阅，当你很清楚事件源的情况下，是很有效的方法。但是，如果你只是希望在一个频道中接收各种通知消息，不管事件源到底是具体什么系统，且这些系统不想做大的改造的话，Microsoft Teams还提供一种更加灵活的、也是Teams原生的实现方式。

## 按需接收外部系统的通知

Office 365 连接器的实现方案中，有一个关键的技术细节，就是用户完成配置后，客户端会负责把一个内部的 **Webhook地址** 提交给外部事件源，以便事件源在需要时可以通过给这个地址发送消息来实现推送。

那么，假设我们能为每个频道生成一个唯一的 Webhook 地址，然后把这些地址分发给受信任的外部应用系统，让他们自己决定在什么时候给这个地址发送消息即可，是不是也是一种不错的方案呢？

这个实现方式，在Microsoft Teams中叫做 `Incoming webhook`, 中文也可以说 `传入钩子` 吧。

![](../../.gitbook/assets/tu-pian-%20%2835%29.png)

配置 Incoming Webhook 很容易，只需要提供一个名称和图标即可。

![](../../.gitbook/assets/tu-pian-%20%2830%29.png)

这样你可以得到了一个URL, 你可以用任何熟悉的语言

## **在客户端中发送消息给外部系统**



